# Class Assignment 2 Part 2 - DEVOPS - Joao Vieira 1231835

## Introduction

The goal of Part 2 of the 2nd class assignment was convert the basic version from Class Assignment 1 into Gradle (instead of Maven)

My assignment's repository can be found [here](https://github.com/Joao-Vieira-1231835/devops-23-24-JPE-JPM-1231835).

## Table of Contents

1. [Setup](#Setup)
2. [Tasks](#Tasks)
   - [Part 1: Copy jar to dist folder](#Part-1-Copy-jar-to-dist-folder)
   - [Part 2: Delete files generated by webpack before cleanTask](#Part-2-Delete-files-generated-by-webpack-before-cleanTask)
3. [Issues](#Issues)
4. [Alternative to Gradle: Maven](#Alternative-to-Gradle-Maven)
5. [Summary](#Summary)

## Setup

First thing I did was to create a new branch in my repository called 'tut-basic-gradle'

1. In the IDE's terminal, in Git Bash (this steps create the branch and 'step into' it):
   ```bash
   git branch tut-basic-gradle
   git checkout tut-basic-gradle
   ```

Then, generated a zip file with the dependencies from 'start.spring.io' as instructed in the slides and extracted them to a CA2/Part2 file in my machine.

Also, deleted the '.src' folder since I wanted to use the code from Class Assignment 1

2. Starting from the CA1's project directory, followed the steps:
   ```bash
   cd ../
   cd ./CA2/Part2/react-and-spring-data-rest-basic
   ls (to check if 'src' folder was there)
   rm -r ./src
   ls (to check if src was no longer there)
   ```

3. Copied the 'src' folder and all its subfolder as well as the 'webpack.config.js' and 'package.json' files from
the basic tutorial in CA1 into the newly created folder CA2/Part2:
   ```bash
   cp -r ./src /d/DEVOPS/RepositoryDEVOPS/CA2/Part2/react-and-spring-data-rest-basic
   cp -r ./package.json /d/DEVOPS/RepositoryDEVOPS/CA2/Part2/react-and-spring-data-rest-basic
   cp -r ./webpack.config.js /d/DEVOPS/RepositoryDEVOPS/CA2/Part2/react-and-spring-data-rest-basic
   ```

After that, I deleted the folder 'src/main/resources/static/built/' since this folder should be generated by the webpack tool from javascript

Finally, added the gradle plugin org.siouan.frontend to the project's build.gradle, while adding code to it and also updated the scripts section
in package.json as instructed in the slides.

These were the steps:

4. Added ´ "packageManager": "npm@9.6.7", ' to the beggining of the 'package.json' file as seen below:

   ```json
   {
   	"name": "spring-data-rest-and-reactjs",
  	"version": "0.1.0",
  	"description": "Demo of ReactJS + Spring Data REST",
  	"packageManager": "npm@9.6.7",
  	"repository": {
    	"type": "git",
    	"url": "git@github.com:spring-guides/tut-react-and-spring-data-rest.git"
   },
   ```

5. Added the following to 'build.gradle' dependencies:

   ```groovy
   testImplementation('org.junit.jupiter:junit-jupiter-api:5.7.2')
   testRuntimeOnly('org.junit.jupiter:junit-jupiter-engine:5.7.2')
   ```

Finally, ran the commands:

6. So that the tasks related to the frontend are executed and its code is generated, and executed the application:

   ```bash
   ./gradlew build
   ./gradlew bootRun
   ```

Went to localhost [webpage](http://localhost:8080/) to verify that everything was working (I could see the table with name: frodo and so on)


### Tasks
#### Part 1: Copy jar to dist folder

For this part of the assignment a task had to be added to gradle, so that it could copy the generated jar to a folder named ”dist” located a
the project root folder level

The task 'copyJarToDist' defines a new task of type Copy, which is a task type provided by Gradle for copying files and directories.

'dependsOn assemble' specifies that this task depends on the assemble task. This means copyJarToDist will only run after assemble completes successfully.

'from jar' indicates the source of the files to copy. In this context, jar refers to the output of the jar task, which generates the 'jar' file.

'into "${project.rootDir}/dist"' specifies the destination directory for the copied files.

'assemble.finalizedBy(copyJarToDist)' tells Gradle to run the copyJarToDist task immediately after the assemble task completes. This is a way to automatically 
trigger the copying of the JAR file whenever the assemble task is executed.


1. 
```groovy
task copyJarToDist(type: Copy) {
    dependsOn assemble
    from jar
    into "${project.rootDir}/dist"
}

assemble.finalizedBy(copyJarToDist)
```

2.
```bash
./gradlew build
```


#### Part 2: Delete files generated by webpack before cleanTask

For this part, I added a task to build.gradle to delete all the files generated by webpack (usually located at src/resources/main/static/built/). This new task should be executed automatically by gradle before the task clean.

'deleteWebpackGeneratedFiles' task: This task uses the delete method to remove all files under src/main/resources/static/built.

'clean.dependsOn deleteWebpackGeneratedFiles': This line makes sure that deleteWebpackGeneratedFiles is executed before the clean task (which is embedded into buil.gradle).

This ensures that the webpack-generated files are cleaned up before the clean task runs.

1. Did the following:
```groovy
task deleteWebpackGeneratedFiles {
	doLast {
		delete fileTree(dir: 'src/main/resources/static/built', include: '**/*')
	}
}
clean.dependsOn deleteWebpackGeneratedFiles
```

2. After that, ran these commands to check all was working:

```bash
./gradlew build
./gradlew bootRun
```

3. Finally, merged with the master branch:

```bash
git push origin tut-basic-gradle
git checkout main
git merge --no-ff tut-basic-gradle 
git push
```


### Issues

During the process of this assignment two Issues were created in order to create a direction of where the work flow should point to. As if it were a to-do list.

The Following Issues were created:

1. Create a new branch called tut-basic-gradle, start a new gradle spring boot project, extract to a folder CA2/Part2 and copy src folder+webpack.config.js+package.json from CA1 #9
2. Add a task to gradle to copy the generated jar to a folder named ”dist” located a the project root folder level #10
3. Add a task to gradle to delete all the files generated by webpack, which should be executed before the task clean #11
4. Creation of readMe file #12


### Alternative to Gradle: Maven

In the previous sections of this tutorial, I explained how to set up and run a Java-based project using Gradle. 

However, Gradle is not the only build automation tool available for such tasks. Maven offers a structured yet flexible approach to managing project builds. 

In this part of the tutorial, I will explore how to achieve similar goals using Maven.

Maven is known for its convention-over-configuration approach, which simplifies the project setup and configuration process.

Just like Gradle, Maven also manages project dependencies.

Here's how I would do it in 4 broad steps:

1. Maven Setup:

Just like I did in the initial setup in the Gradle tutorial, this alternative would have me create a new Maven project.
I would need to generate a Maven project structure using the same steps on the Spring Initializr website as before, but selecting Maven instead.
This would also need altering the 'pom.xml' file with the following dependencies:

```xml
 <dependencies>
        <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter-api</artifactId>
            <version>5.7.2</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter-engine</artifactId>
            <version>5.7.2</version>
            <scope>test</scope>
        </dependency>
    </dependencies>
```

2. Task - Copy jar to dist folder:

Maven doesn't use tasks like Gradle but achieves similar goals through plugins:

```xml
<plugin>
    <artifactId>maven-antrun-plugin</artifactId>
    <version>3.0.0</version>
    <executions>
        <execution>
            <phase>install</phase>
            <configuration>
                <target>
                    <copy file="${project.build.directory}/${project.build.finalName}.jar" todir="${project.basedir}/dist"/>
                </target>
            </configuration>
            <goals>
                <goal>run</goal>
            </goals>
        </execution>
    </executions>
</plugin>
```

3. Task - Delete files generated by webpack before cleanTask:

To delete files before the clean phase, I could configure the maven-clean-plugin like so:

```xml
<plugin>
    <artifactId>maven-clean-plugin</artifactId>
    <version>3.1.0</version>
    <configuration>
        <filesets>
            <fileset>
                <directory>src/main/resources/static/built</directory>
                <includes>
                    <include>**/*</include>
                </includes>
            </fileset>
        </filesets>
    </configuration>
</plugin>
```


4. Building and running:
```bash
mvn clean install
mvn spring-boot:run
```


### Summary

As I finnish this tutorial on converting a basic Java project to Gradle, several key insights emerge.

This process has not only demonstrated the versatility and utility of both build tools but also highlighted their distinctive approaches to project management and automation.

Throughout this tutorial I adapted an existing project integrating tasks that enhance the operational efficiency and clarity of the development process. 

This approach allowed me to step into practical scenarios that are commonly encountered in real-world software development.
